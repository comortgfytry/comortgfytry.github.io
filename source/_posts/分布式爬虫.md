---
title: 分布式爬虫
summary: 0基础入门分布式爬虫，利用python完成对旅游网站信息爬取的demo
tags:
  - 爬虫
  - Python
categories: 爬虫
keywords: Python分布式爬虫
abbrlink: 19872
date: 2023-07-19 11:28:00
---
# 认识分布式爬虫
## 分布式 
1、生产端和消费端的隔离  
2、同一端的worker之间隔离
## 消息队列
存储要爬取的网页url，便于生产端产出，消费端获取（一次一个）  
避免重复爬取 
* 使用redis队列做消息队列
> 最基本方法：生产者通过lpush存入，消费者通过rpop从队列中获取

```Python
import redis
# 生产端
r = redis.Redis(host='17.0.0.1', port=1111,password='pwd',db=name)
# 产生
for i in range(10):
    r.lpush('url_queue',i)
```

```Python
import time
import redis
# 消费端

r = redis.Redis(host='127.0.0.1', port=6379,
                password='yourpassword', db=1)

# 爬虫程序
def crawl(task):
    print('爬取url {task}'.format(task=task))
    time.sleep(1)


while True:
    task = r.rpop('url_queue')
    if not task:
        time.sleep(1)
        continue

    crawl(task)
```
